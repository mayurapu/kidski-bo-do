<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>ã€ç·´ç¿’ã€‘ã‚·ãƒ§ãƒ¼ãƒˆã‚«ãƒƒãƒˆã€Œå®ˆã‚Šã€ã®ä¿®è¡Œï¼</title>
  <link href="https://fonts.googleapis.com/css2?family=Kosugi+Maru&display=swap" rel="stylesheet">
  <style>
    body {
      background-color: #2c3e50;
      font-family: "UD Digi Kyokasho N-R", "Kosugi Maru", sans-serif;
      margin: 20px;
      text-align: center;
      color: #ecf0f1;
      overflow-x: hidden;
      transition: background-color 0.3s;
    }
    body.danger-alert { background-color: #c0392b; }
    h1 {
      color: #f1c40f;
      font-size: 24px;
      border-bottom: 4px solid #f1c40f;
      display: inline-block;
      margin-bottom: 10px;
    }
    .info-box {
      background: rgba(255, 255, 255, 0.1);
      border: 3px solid #f1c40f;
      border-radius: 20px;
      padding: 10px;
      margin: 0 auto 10px;
      max-width: 600px;
    }
    .mission-area {
      font-size: 26px;
      font-weight: bold;
      height: 70px;
      margin-top: 10px;
    }
    #target-container {
      background: #fff;
      color: #333;
      padding: 20px;
      border-radius: 15px;
      font-size: 45px;
      margin: 10px auto;
      max-width: 500px;
      min-height: 100px;
      display: flex;
      align-items: center;
      justify-content: center;
      border: 8px solid #bdc3c7;
    }
    .input-zone {
      margin: 20px auto;
      width: 550px;
      position: relative;
    }
    .command-label {
      background: #f1c40f;
      color: #333;
      font-weight: bold;
      font-size: 22px;
      padding: 5px 15px;
      border-radius: 10px 10px 0 0;
      display: inline-block;
      box-shadow: 0 -3px 10px rgba(0,0,0,0.2);
    }
    input#magic-input {
      font-size: 32px;
      padding: 20px;
      width: 100%;
      box-sizing: border-box;
      text-align: center;
      border-radius: 0 0 15px 15px;
      border: 6px solid #f1c40f;
      background: #ecf0f1;
      outline: none;
    }
    #result-overlay {
      display: none;
      position: fixed;
      top: 0; left: 0; width: 100%; height: 100%;
      background: rgba(0,0,0,0.9);
      z-index: 100;
      justify-content: center;
      align-items: center;
      flex-direction: column;
    }
    .result-card {
      background: white;
      color: #333;
      padding: 40px;
      border-radius: 30px;
      border: 10px solid #f1c40f;
      text-align: center;
    }
    .result-score { font-size: 80px; color: #e67e22; margin: 20px 0; display: block; }
  </style>
</head>
<body onload="initGame()">

  <h1>âœ¨ ã‚·ãƒ§ãƒ¼ãƒˆã‚«ãƒƒãƒˆã€Œå®ˆã‚Šã€ã®ä¿®è¡Œ âœ¨</h1>

  <div class="info-box">
    <div style="font-size: 22px; font-weight: bold;">
      ã®ã“ã‚Šï¼š<span id="timer">60</span>ç§’ã€€
      å®ˆã£ãŸæ•°ï¼š<span id="score">0</span>
    </div>
  </div>

  <div class="mission-area" id="mission-text">ãŸã„ã›ã¤ãªã‚‚ã®ã‚’å®ˆã‚‹ä¿®è¡Œã ï¼</div>

  <div id="target-container"><span id="display-text">---</span></div>

  <div class="input-zone">
    <div id="current-command" class="command-label">ã‚ãã‚’ã‚¯ãƒªãƒƒã‚¯ï¼</div>
    <input type="text" id="magic-input" oninput="checkAction()" autocomplete="off">
    
    <div id="reset-hint" style="margin-top:10px; color:#fffa00; font-weight:bold; display:none;">
      âš ï¸ ã‚‚ã©ã›ãªã„ï¼ã€Enterã€‘ã§ã¤ãã¸ï¼
    </div>
  </div>

  <p style="color:#bdc3c7;">â€» 1æ–‡å­—ãšã¤æ¶ˆã™ã¨é­”æ³•ã¯ã—ã£ã±ã„ã ï¼</p>

  <div id="result-overlay">
    <div class="result-card">
      <h2 style="font-size: 32px;">ğŸ‰ ä¿®è¡Œçµ‚äº† ğŸ‰</h2>
      <p style="font-size: 20px;">å›ãŒå®ˆã‚Šãã£ãŸæ•°ã¯...</p>
      <span class="result-score" id="final-score">0</span>
      <p style="font-size: 18px;">ç”»é¢ã‚’æ›´æ–°(F5)ã—ã¦ã‚‚ã†ä¸€å›ï¼</p>
    </div>
  </div>

  <script>
    let score = 0;
    let timeLeft = 60;
    let isPlaying = false;
    let timerID;
    let phase = 1; 
    let currentItem = "";

    const PROTECT_ITEMS = ["ğŸ’ ä¼èª¬ã®ãƒ€ã‚¤ãƒ¤ ğŸ’", "ğŸ‚ è±ªè¯ãªã‚±ãƒ¼ã‚­ ğŸ‚", "ğŸ¶ ã‹ã‚ã„ã„å­çŠ¬ ğŸ¶", "ğŸ± ã¾ã‚“ã¾ã‚‹ãƒã‚³ ğŸ±", "ğŸ® æ–°ä½œã‚²ãƒ¼ãƒ  ğŸ®", "ğŸ¦ ç‰¹å¤§ã‚¢ã‚¤ã‚¹ ğŸ¦"];
    const missionText = document.getElementById("mission-text");
    const displayText = document.getElementById("display-text");
    const magicInput = document.getElementById("magic-input");
    const commandLabel = document.getElementById("current-command");
    const resetHint = document.getElementById("reset-hint");

    function initGame() {
      score = 0; timeLeft = 60; isPlaying = false;
      document.getElementById("score").textContent = score;
      document.getElementById("timer").textContent = timeLeft;
      nextMission();
    }

    function nextMission() {
      phase = 1;
      resetHint.style.display = "none";
      currentItem = PROTECT_ITEMS[Math.floor(Math.random() * PROTECT_ITEMS.length)];
      displayText.textContent = currentItem;
      magicInput.value = currentItem;
      
      document.body.classList.add("danger-alert");
      missionText.innerHTML = "<span style='animation: blink 0.5s infinite; color:#fffa00;'>ğŸ’£ çˆ†å¼¾ã ï¼ã²ãªã‚“ã•ã›ã¦ï¼ ğŸ’£</span>";
      commandLabel.innerHTML = "Ctrl + A â†’ Backspace";
      commandLabel.style.background = "#fffa00";
      magicInput.focus();
    }

    function checkAction() {
      if (!isPlaying) startTimer();

      if (phase === 1) {
        // â–¼ ã“ã“ãŒã€ŒæŠ¼ã—ãƒŸã‚¹ãƒ»ãƒ•ã‚©ãƒ­ãƒ¼æ©Ÿèƒ½ã€ï¼
        // æ–‡å­—ãŒå¢—ãˆãŸï¼ˆï¼Ctrlã‚’æŠ¼ã—å¿˜ã‚Œã¦æ–‡å­—ã‚’æ‰“ã£ã¡ã‚ƒã£ãŸï¼‰å ´åˆ
        if (magicInput.value.length > currentItem.length) {
            magicInput.select(); // å¼·åˆ¶çš„ã«ã€Œå…¨é¸æŠã€çŠ¶æ…‹ã«ã™ã‚‹ï¼
            commandLabel.innerHTML = "ãã®ã¾ã¾ Backspace ã‚’ãŠã—ã¦ï¼";
            return;
        }

        if (magicInput.value === "") {
          phase = 2;
          document.body.classList.remove("danger-alert");
          missionText.innerHTML = "<span style='color:#55efc4'>ã‚ˆã—ï¼å®‰å…¨ã ï¼æˆ»ã—ã¦ï¼</span>";
          commandLabel.innerHTML = "Ctrl + Z";
          commandLabel.style.background = "#55efc4";
          displayText.textContent = "ï¼ˆã²ãªã‚“ä¸­...ğŸ’¨ï¼‰";
          setTimeout(() => { if(phase === 2) resetHint.style.display = "block"; }, 3500);
        }
      } 
      else if (phase === 2 && magicInput.value === currentItem) {
        success();
      }
    }

    window.onkeydown = function(e) {
      if (e.keyCode === 13 && phase === 2) nextMission();
    };

    function success() {
      score++;
      document.getElementById("score").textContent = score;
      displayText.textContent = "âœ¨ ãŠã‹ãˆã‚Šï¼ âœ¨";
      commandLabel.innerHTML = "æˆåŠŸï¼ï¼";
      commandLabel.style.background = "#fff";
      phase = 0;
      setTimeout(nextMission, 600);
    }

    function startTimer() {
      isPlaying = true;
      timerID = setInterval(() => {
        timeLeft--;
        document.getElementById("timer").textContent = timeLeft;
        if (timeLeft <= 0) endGame();
      }, 1000);
    }

    function endGame() {
      clearInterval(timerID);
      magicInput.readOnly = true;
      document.body.classList.remove("danger-alert");
      document.getElementById("final-score").textContent = score;
      document.getElementById("result-overlay").style.display = "flex";
    }
  </script>

  <style>
    @keyframes blink { 0% { opacity: 1; } 50% { opacity: 0.5; } 100% { opacity: 1; } }
  </style>
</body>
</html>